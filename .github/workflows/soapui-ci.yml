name: Test SOAP WebServices

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  run-soapui-tests:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Set up Java
      uses: actions/setup-java@v3
      with:
        java-version: '11'

    - name: Download and install SoapUI
      run: |
        wget https://s3.amazonaws.com/downloads.eviware/soapuios/5.8.0/SoapUI-5.8.0-linux-bin.tar.gz
        tar -xzf SoapUI-5.8.0-linux-bin.tar.gz
        mv SoapUI-5.8.0 soapui

    - name: Extract SOAPUI project
      run: |
        unzip Projet/Stage1.zip -d Projet/Stage1_extracted

    - name: Run SOAPUI tests
      run: |
        ./soapui/bin/testrunner.sh \
          -r -j -f Projet/reports \
          Projet/Stage1_extracted/stage-soapui-project.xml

    # - name: Archive test reports
#   uses: actions/upload-artifact@v3.1.2
#   with:
#     name: soapui-reports
#     path: Projet/reports

